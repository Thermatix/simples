{"version":3,"sources":["../Users/jasonmiller/Projects/preact-richtextarea/src/index.js"],"names":["UID","Math","random","toString","substring","EMPTY_VALUE","RichTextArea","_Component","props","call","this","componentDidUpdate","_this","bind","updateHeight","handleEvent","doFocus","prototype","exec","command","doc","getDocument","args","Array","_len","_key","arguments","apply","execCommand","_len2","_key2","concat","queryCommandState","queryCommandValue","componentDidMount","updateHeightTimer","setInterval","componentWillUnmount","shouldComponentUpdate","_ref","value","stylesheet","placeholder","babelHelpers","objectWithoutProperties","i","updateTimer","setup","editor","getEditor","editorRetries","setTimeout","current","innerHTML","setStyleSheet","placeholderShowing","updatePlaceholder","s","getElementById","parentNode","removeChild","head","getElementsByTagName","body","insertBefore","createElement","setAttribute","appendChild","createTextNode","_hasbeensetup","open","write","close","designMode","documentElement","style","cursor","overflowY","minHeight","contentEditable","win","getFrame","contentWindow","onfocus","onblur","oninput","onchange","onscroll","onload","uht","br","_br","cssText","ph","offsetTop","offsetHeight","frame","height","base","firstChild","document","getHandler","type","toLowerCase","_ref2","target","fn","focussed","focus","currentTarget","norm","normalizeEmptyValue","show","removeAttribute","replace","e","a","preventDefault","render","_ref3","cl","className","hasOwnProperty","match","preact","h","class","_ref4","defineProperty","onFocus","tabIndex","is-placeholder","Component"],"mappings":"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","file":"preact-richtextarea.js","sourcesContent":["import { h, Component } from 'preact';\nimport './style.css';\n\nconst UID = Math.random().toString(32).substring(2);\n\nconst EMPTY_VALUE = '<br>';\n\nexport default class RichTextArea extends Component {\n\tconstructor(props) {\n\t\tsuper(props);\n\t\tthis.componentDidUpdate = this.componentDidUpdate.bind(this);\n\t\tthis.updateHeight = this.updateHeight.bind(this);\n\t\tthis.handleEvent = this.handleEvent.bind(this);\n\t\tthis.doFocus = this.doFocus.bind(this);\n\t}\n\n\texec(command, ...args) {\n\t\tlet doc = this.getDocument();\n\t\tif (doc) return doc[command](...args);\n\t}\n\n\texecCommand(command, ...args) {\n\t\treturn this.exec('execCommand', command, ...args);\n\t}\n\n\tqueryCommandState(command) {\n\t\treturn this.exec('queryCommandState', command);\n\t}\n\n\tqueryCommandValue(command) {\n\t\treturn this.exec('queryCommandValue', command);\n\t}\n\n\tcomponentDidMount() {\n\t\tthis.updateHeightTimer = setInterval(this.updateHeight, 1000);\n\t}\n\n\tcomponentWillUnmount() {\n\t\tclearInterval(this.updateHeightTimer);\n\t}\n\n\tshouldComponentUpdate({ value, stylesheet, placeholder, ...props }) {\n\t\tfor (let i in props) if (props[i]!==this.props[i]) return true;\n\t\tthis.props = { ...this.props, value, placeholder, stylesheet };\n\t\tthis.componentDidUpdate();\n\t\treturn false;\n\t}\n\n\tcomponentDidUpdate() {\n\t\tclearTimeout(this.updateTimer);\n\t\tthis.setup();\n\n\t\tlet editor = this.getEditor();\n\t\tif (!editor) {\n\t\t\tthis.editorRetries = (this.editorRetries || 0) + 1;\n\t\t\tthis.updateTimer = setTimeout(this.componentDidUpdate, this.editorRetries>10 ? 100 : 1);\n\t\t\treturn;\n\t\t}\n\t\tthis.editorRetries = 0;\n\n\t\tlet value = this.props.value || EMPTY_VALUE,\n\t\t\tstylesheet = this.props.stylesheet,\n\t\t\tcurrent = editor.innerHTML;\n\n\t\tif (stylesheet!==this.stylesheet) {\n\t\t\tthis.setStyleSheet(stylesheet);\n\t\t}\n\n\t\tif (this.placeholderShowing===true && current===this.props.placeholder) {\n\t\t\tcurrent = EMPTY_VALUE;\n\t\t}\n\t\tif (current!==value) {\n\t\t\teditor.innerHTML = value;\n\t\t}\n\t\tthis.updatePlaceholder();\n\t\tthis.updateHeight();\n\t}\n\n\tsetStyleSheet(stylesheet) {\n\t\tthis.stylesheet = stylesheet;\n\t\tlet doc = this.getDocument(),\n\t\t\ts = doc.getElementById('prtcss'+UID);\n\t\tif (s) s.parentNode.removeChild(s);\n\n\t\tlet head = doc.head || doc.getElementsByTagName('head')[0];\n\t\tif (!head) head = doc.body.parentNode.insertBefore(doc.createElement('head'), doc.body);\n\n\t\ts = doc.createElement('style');\n\t\ts.setAttribute('id', 'prtcss'+UID);\n\t\ts.appendChild(doc.createTextNode(stylesheet));\n\t\thead.appendChild(s);\n\t}\n\n\tsetup() {\n\t\tlet doc = this.getDocument();\n\t\tif (!doc || (doc.body && doc.body._hasbeensetup===true)) return;\n\n\t\tif (!doc.body) {\n\t\t\tdoc.open();\n\t\t\tdoc.write('<!DOCTYPE html><html><body contentEditable></body></html>');\n\t\t\tdoc.close();\n\t\t}\n\t\tdoc.designMode = 'on';\n\t\tdoc.documentElement.style.cursor = 'text';\n\t\tdoc.documentElement.style.overflowY = doc.body.style.overflowY = 'hidden';\n\t\tdoc.body.style.minHeight = '1.2em';\n\t\tdoc.body.contentEditable = true;\n\t\tdoc.body._hasbeensetup = true;\n\t\tlet win = this.getFrame().contentWindow;\n\t\twin.onfocus = win.onblur = win.oninput = win.onchange = this.handleEvent;\n\t\twin.onscroll = win.onload = this.updateHeight;\n\t}\n\n\tupdateHeight() {\n\t\tclearTimeout(this.uht);\n\t\tthis.uht = null;\n\t\tlet doc = this.getDocument(),\n\t\t\tbr = doc && doc._br;\n\t\tif (!doc) return;\n\t\tif (!br) {\n\t\t\tbr = doc._br = doc.createElement('div');\n\t\t\tbr.style.cssText = 'position:relative;overflow:hidden;clear:both;';\n\t\t}\n\t\tdoc.body.appendChild(br);\n\t\tlet ph = br.offsetTop + doc.documentElement.offsetHeight - doc.body.offsetHeight;\n\t\tdoc.body.removeChild(br);\n\n\t\tlet frame = this.getFrame();\n\t\tif (ph!==frame.offsetHeight) {\n\t\t\tframe.style.height = ph+'px';\n\t\t}\n\t}\n\n\tgetFrame() {\n\t\treturn this.base && this.base.firstChild;\n\t}\n\n\tgetDocument() {\n\t\tlet frame = this.getFrame();\n\t\treturn frame && frame.contentWindow && frame.contentWindow.document;\n\t}\n\n\tgetEditor() {\n\t\tlet doc = this.getDocument();\n\t\treturn doc && doc.body;\n\t}\n\n\tgetHandler(type) {\n\t\tfor (let i in this.props) if (i.toLowerCase()==='on'+type) return this.props[i];\n\t}\n\n\thandleEvent({ type, target }) {\n\t\tlet fn = this.getHandler(type),\n\t\t\teditor = this.getEditor(),\n\t\t\tvalue = editor.innerHTML;\n\t\ttarget = editor || target;\n\t\tif (type==='focus' || type==='blur') {\n\t\t\tthis.focussed = type==='focus';\n\t\t\tthis.updatePlaceholder();\n\t\t\tif (type==='focus') target.focus();\n\t\t}\n\t\tif (fn) fn({ value, type, target, currentTarget:this });\n\t\tif (!this.uht) {\n\t\t\tthis.uht = setTimeout(this.updateHeight, 20);\n\t\t}\n\t}\n\n\tupdatePlaceholder() {\n\t\tlet { placeholder } = this.props,\n\t\t\teditor = this.getEditor(),\n\t\t\tvalue = editor.innerHTML,\n\t\t\tnorm = this.normalizeEmptyValue(value),\n\t\t\tshow = (!norm || norm===EMPTY_VALUE || norm===placeholder) && placeholder && !this.focussed;\n\n\t\tif (show===this.placeholderShowing) return;\n\t\tthis.placeholderShowing = show;\n\n\t\tif (show) {\n\t\t\tif (!norm) editor.innerHTML = placeholder;\n\t\t\tthis.base.setAttribute('is-placeholder', 'true');\n\t\t}\n\t\telse {\n\t\t\tif (value===placeholder) editor.innerHTML = EMPTY_VALUE;\n\t\t\tthis.base.removeAttribute('is-placeholder');\n\t\t}\n\t}\n\n\tnormalizeEmptyValue(value) {\n\t\treturn typeof value==='string' ? value.replace(/^[\\s\\n]*?(<br\\s*?\\/?>)?[\\s\\n]*?$/gi, '') : '';\n\t}\n\n\tdoFocus(e) {\n\t\tlet a = this.getEditor();\n\t\tif (a) a.focus();\n\t\tif (e) return e.preventDefault(), false;\n\t}\n\n\trender({ value, class:cl, className, placeholder, stylesheet, ...props }) {\n\t\tfor (let i in props) if (props.hasOwnProperty(i) && i.match(/^on/i) && typeof props[i]==='function') delete props[i];\n\t\treturn (\n\t\t\t<richtextarea class={{\n\t\t\t\t'preact-richtextarea': true,\n\t\t\t\t[cl]: cl,\n\t\t\t\t[className]: className\n\t\t\t}} {...props} onFocus={this.doFocus} tabIndex=\" \" is-placeholder={ (!value && !!placeholder) || null }>\n\t\t\t\t<iframe />\n\t\t\t</richtextarea>\n\t\t);\n\t}\n}\n"]}
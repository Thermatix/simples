!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?module.exports=t(require("preact")):"function"==typeof define&&define.amd?define(["preact"],t):e.preactRichTextArea=t(e.preact)}(this,function(e){"use strict";function t(e){e=e||"";var t=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css",o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e)),t.appendChild(o)}var o={};o.classCallCheck=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")},o.defineProperty=function(e,t,o){return t in e?Object.defineProperty(e,t,{value:o,enumerable:!0,configurable:!0,writable:!0}):e[t]=o,e},o["extends"]=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var o=arguments[t];for(var n in o)Object.prototype.hasOwnProperty.call(o,n)&&(e[n]=o[n])}return e},o.inherits=function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)},o.objectWithoutProperties=function(e,t){var o={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(o[n]=e[n]);return o},o.possibleConstructorReturn=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t},t(".preact-richtextarea{\n	display:block;\n	width:100%;\n	min-height:22px;\n	padding:2px;\n	background-color:white;\n	border:1px solid;\n	resize:auto;\n	cursor:text;\n	overflow:auto;\n}\n\n.preact-richtextarea iframe{\n	position:relative;\n	margin:0;\n	padding:0;\n	width:100%;\n	border:0 !important;\n	background:none !important;\n	overflow:hidden;\n}\n\n.preact-richtextarea[is-placeholder] iframe{\n	opacity:0.5;\n}\n");var n=Math.random().toString(32).substring(2),r="<br>",i=function(t){function i(e){o.classCallCheck(this,i);var n=o.possibleConstructorReturn(this,t.call(this,e));return n.componentDidUpdate=n.componentDidUpdate.bind(n),n.updateHeight=n.updateHeight.bind(n),n.handleEvent=n.handleEvent.bind(n),n.doFocus=n.doFocus.bind(n),n}return o.inherits(i,t),i.prototype.exec=function(e){for(var t=this.getDocument(),o=arguments.length,n=Array(o>1?o-1:0),r=1;o>r;r++)n[r-1]=arguments[r];return t?t[e].apply(t,n):void 0},i.prototype.execCommand=function(e){for(var t=arguments.length,o=Array(t>1?t-1:0),n=1;t>n;n++)o[n-1]=arguments[n];return this.exec.apply(this,["execCommand",e].concat(o))},i.prototype.queryCommandState=function(e){return this.exec("queryCommandState",e)},i.prototype.queryCommandValue=function(e){return this.exec("queryCommandValue",e)},i.prototype.componentDidMount=function(){this.updateHeightTimer=setInterval(this.updateHeight,1e3)},i.prototype.componentWillUnmount=function(){clearInterval(this.updateHeightTimer)},i.prototype.shouldComponentUpdate=function(e){var t=e.value,n=e.stylesheet,r=e.placeholder,i=o.objectWithoutProperties(e,["value","stylesheet","placeholder"]);for(var s in i)if(i[s]!==this.props[s])return!0;return this.props=o["extends"]({},this.props,{value:t,placeholder:r,stylesheet:n}),this.componentDidUpdate(),!1},i.prototype.componentDidUpdate=function(){clearTimeout(this.updateTimer),this.setup();var e=this.getEditor();if(!e)return this.editorRetries=(this.editorRetries||0)+1,void(this.updateTimer=setTimeout(this.componentDidUpdate,this.editorRetries>10?100:1));this.editorRetries=0;var t=this.props.value||r,o=this.props.stylesheet,n=e.innerHTML;o!==this.stylesheet&&this.setStyleSheet(o),this.placeholderShowing===!0&&n===this.props.placeholder&&(n=r),n!==t&&(e.innerHTML=t),this.updatePlaceholder(),this.updateHeight()},i.prototype.setStyleSheet=function(e){this.stylesheet=e;var t=this.getDocument(),o=t.getElementById("prtcss"+n);o&&o.parentNode.removeChild(o);var r=t.head||t.getElementsByTagName("head")[0];r||(r=t.body.parentNode.insertBefore(t.createElement("head"),t.body)),o=t.createElement("style"),o.setAttribute("id","prtcss"+n),o.appendChild(t.createTextNode(e)),r.appendChild(o)},i.prototype.setup=function(){var e=this.getDocument();if(e&&(!e.body||e.body._hasbeensetup!==!0)){e.body||(e.open(),e.write("<!DOCTYPE html><html><body contentEditable></body></html>"),e.close()),e.designMode="on",e.documentElement.style.cursor="text",e.documentElement.style.overflowY=e.body.style.overflowY="hidden",e.body.style.minHeight="1.2em",e.body.contentEditable=!0,e.body._hasbeensetup=!0;var t=this.getFrame().contentWindow;t.onfocus=t.onblur=t.oninput=t.onchange=this.handleEvent,t.onscroll=t.onload=this.updateHeight}},i.prototype.updateHeight=function(){clearTimeout(this.uht),this.uht=null;var e=this.getDocument(),t=e&&e._br;if(e){t||(t=e._br=e.createElement("div"),t.style.cssText="position:relative;overflow:hidden;clear:both;"),e.body.appendChild(t);var o=t.offsetTop+e.documentElement.offsetHeight-e.body.offsetHeight;e.body.removeChild(t);var n=this.getFrame();o!==n.offsetHeight&&(n.style.height=o+"px")}},i.prototype.getFrame=function(){return this.base&&this.base.firstChild},i.prototype.getDocument=function(){var e=this.getFrame();return e&&e.contentWindow&&e.contentWindow.document},i.prototype.getEditor=function(){var e=this.getDocument();return e&&e.body},i.prototype.getHandler=function(e){for(var t in this.props)if(t.toLowerCase()==="on"+e)return this.props[t]},i.prototype.handleEvent=function(e){var t=e.type,o=e.target,n=this.getHandler(t),r=this.getEditor(),i=r.innerHTML;o=r||o,("focus"===t||"blur"===t)&&(this.focussed="focus"===t,this.updatePlaceholder(),"focus"===t&&o.focus()),n&&n({value:i,type:t,target:o,currentTarget:this}),this.uht||(this.uht=setTimeout(this.updateHeight,20))},i.prototype.updatePlaceholder=function(){var e=this.props.placeholder,t=this.getEditor(),o=t.innerHTML,n=this.normalizeEmptyValue(o),i=(!n||n===r||n===e)&&e&&!this.focussed;i!==this.placeholderShowing&&(this.placeholderShowing=i,i?(n||(t.innerHTML=e),this.base.setAttribute("is-placeholder","true")):(o===e&&(t.innerHTML=r),this.base.removeAttribute("is-placeholder")))},i.prototype.normalizeEmptyValue=function(e){return"string"==typeof e?e.replace(/^[\s\n]*?(<br\s*?\/?>)?[\s\n]*?$/gi,""):""},i.prototype.doFocus=function(e){var t=this.getEditor();return t&&t.focus(),e?(e.preventDefault(),!1):void 0},i.prototype.render=function(t){var n,r=t.value,i=t["class"],s=t.className,a=t.placeholder,p=(t.stylesheet,o.objectWithoutProperties(t,["value","class","className","placeholder","stylesheet"]));for(var h in p)p.hasOwnProperty(h)&&h.match(/^on/i)&&"function"==typeof p[h]&&delete p[h];return e.h("richtextarea",o["extends"]({"class":(n={"preact-richtextarea":!0},o.defineProperty(n,i,i),o.defineProperty(n,s,s),n)},p,{onFocus:this.doFocus,tabIndex:" ","is-placeholder":!r&&!!a||null}),e.h("iframe",null))},i}(e.Component);return i});
//# sourceMappingURL=preact-richtextarea.min.js.map